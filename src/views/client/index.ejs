<%- include('header') %>

<h2>🎟️ Cartelera</h2>

<% Object.values(cartelera).forEach(pelicula => { %>
  <section style="border: 1px solid #ccc; padding: 10px; margin-bottom: 20px">
    <h3>
      <%= pelicula.nombre %>
    </h3>
    <p>
      <%= pelicula.resumen %>
    </p>

    <h4>Funciones disponibles:</h4>
    <ul>
      <% pelicula.funciones.forEach(funcion => { %>
        <li>
            <% 
              const fecha = new Date(funcion.horario);
              const dia = fecha.getDate().toString().padStart(2, '0');
              const meses = ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun', 'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic'];
              const mes = meses[fecha.getMonth()];
              const anio = fecha.getFullYear();
              const hora = fecha.getHours().toString().padStart(2, '0');
              const minutos = fecha.getMinutes().toString().padStart(2, '0');
              const horarioFormateado = `- ${hora}:${minutos}`;
            %>
            
          <strong>
            <a href="/comprar/<%= funcion.id_funcion %>">
              <%= horarioFormateado %>
            </a>
          </strong> en sala <%= funcion.sala %>
        </li>
      <% }) %>
    </ul>
  </section>
<% }) %>

<%- include('../partials/footer') %>